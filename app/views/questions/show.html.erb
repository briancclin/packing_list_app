<div class="container-fluid">
<h1> Question <%= @question.position %> </h1>

<p><%= @question.question %></p>

<% if @question.id == 1 %>
      <div class="row-fluid form-group">
        <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, 'international = true', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">International</button>
      </div>
      <div class="row-fluid form-group">
        <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, 'domestic = true', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">Domestic</button>
      </div>
<% elsif @question.id == 5 %>
      <div class="row-fluid form-group">
        <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, '0-3 days', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">0-3 days</button>
      </div>
      <div class="row-fluid form-group">
        <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, '4-7 days', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">4-7 days</button>
      </div>
      <div class="row-fluid form-group">
        <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, '8-14 days', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">8-14 days</button>
      </div>
      <p>
      <div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          14+ days
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <h6 class="dropdown-header">Is there a washer/dryer?</h6>
          <div class="row-fluid form-group">
            <button type="button" class="btn btn-primary dropdown-item" onclick="toggleButton(this, 'Washer/Dryer', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">Yes</button>
          </div>
          <div class="row-fluid form-group">
            <button type="button" class="btn btn-primary dropdown-item" onclick="toggleButton(this, 'No Washer/Dryer', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">No</button>
          </div>
        </div>
      </div>
      </p>
<% else %>
  <% unless @choices.nil? %>
    <% @choices.each do |choice| %>
      <% if choice["#{@table_name}"] == 'Airplane' %>
        <p>
        <div class="dropdown">
          <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Airplane
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <h6 class="dropdown-header">What type of flight?</h6>
            <button type="button" class="dropdown-item" onclick="toggleButton(this, '<%= "#{@table_name}_id = #{@table.find_by(@table_name.to_s => choice["#{@table_name}"]).id.to_s} AND normal = true" %>', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">Normal</button>
            <button type="button" class="dropdown-item" onclick="toggleButton(this, '<%= "#{@table_name}_id = #{@table.find_by(@table_name.to_s => choice["#{@table_name}"]).id.to_s}" %>', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off">Over 5 Hours / Redeye</button>
          </div>
        </div>
        </p>
      <% else %>
        <div class="row-fluid form-group">
          <button type="button" class="btn btn-primary btn-toggle" onclick="toggleButton(this, '<%= "#{@table_name}_id = #{@table.find_by(@table_name.to_s => choice["#{@table_name}"]).id.to_s}" %>', <%= @question.id %>)" data-toggle="button" aria-pressed="false" autocomplete="off"><%= choice["#{@table_name}"] %></button>
        </div>
      <% end %>
    <% end %>
  <% end %>
<% end %>

<%= link_to("Previous", @question.previous) if @question.previous %>
<%= link_to("Next", @question.next) if @question.next %>
<%= link_to("Finish", :controller => :answers, :action => :index) if @question.next.nil? %>
</div>

<script>
    $.ajaxSetup({
        headers: {
            'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
        }
    });

    function toggleButton(button, text, id) {
        if(button.style.backgroundColor == 'lightgray') {
            if (button.classList.contains('dropdown-item')) {
                button.style.backgroundColor = "transparent";
                button.style.opacity = "1";
            }
        }
        else if(button.style.backgroundColor == 'darkblue') {
              button.style.backgroundColor = 'blue';
            $.post( "/answers/remove", { text: text, id: id} );
        }
        else {
            if(button.classList.contains('dropdown-item')) {
                button.style.backgroundColor ='lightgray';
            }
            else
              button.style.backgroundColor ='darkblue';
            $.post( "/answers", { text: text, id: id} );
        }
    }
</script>
